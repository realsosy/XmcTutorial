/******************************************************************************/
/**
 * file         Ultrasonic.c
 *
 * brief        C file for Ultrasonic
 *
 * version      1.00
 * date         Feb/27/2010
 * warning
 * note
 * ---------------------------------------------------------------------------
 *               R E V I S I O N   H I S T O R Y
 * ---------------------------------------------------------------------------
 *   Date        Version  Author  Description
 *  ----------   -------  ------  --------------------------------------------
 *  2018-09-27   1.00             - Creation Release
 *
 */
/******************************************************************************/

/******************************************************************************/
/* HEADER FILES                                                               */
/******************************************************************************/

#include "Ultrasonic.h"


/******************************************************************************/
/* PRIVATE DEFINITIONS AND MACROS (scope: file)                               */
/******************************************************************************/


/******************************************************************************/
/* PRIVATE TYPEDEFS AND STRUCTURES (scope: file)                              */
/******************************************************************************/


/******************************************************************************/
/* PUBLIC VARIABLES                                                           */
/******************************************************************************/
uint32_t u32CapturedTick;
float fltCapturedTime;
float fltDistance;
uint32_t u32SwTimer_60ms;
/******************************************************************************/
/* PRIVATE VARIABLES                                                          */
/******************************************************************************/
//static int32_t MyPrivate;


/******************************************************************************/
/* PRIVATE Function Prototype (scope: file)                                   */
/******************************************************************************/


/******************************************************************************/
/* PRIVATE Function Implementation (scope: file)                              */
/******************************************************************************/


/******************************************************************************/
/* PUBLIC Function Implementation                                             */
/******************************************************************************/
void CB_dhSYSTIMER_0_u32SwTimer_60ms(void)
{
		CAPTURE_GetCapturedTime(&dhCAPTURE_0, &u32CapturedTick);
		fltCapturedTime = (float)u32CapturedTick * 533.33 / 1000.0;
		fltDistance = fltCapturedTime / 58.0;
}

void Ultrasonic_Init(void)
{
	u32SwTimer_60ms = SYSTIMER_CreateTimer(UR_RES, SYSTIMER_MODE_PERIODIC, (void*)CB_dhSYSTIMER_0_u32SwTimer_60ms, NULL);
	SYSTIMER_StartTimer(u32SwTimer_60ms);
}

/******************************************************************************/
/*                                                                            */
/*                            EOF                                             */
/*                                                                            */
/******************************************************************************/

